<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A股盘前要闻</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;600;700&family=JetBrains+Mono:wght@300;400&display=swap');
  :root {
    --red:#c0392b;--red-light:#e74c3c;--gold:#d4a843;
    --dark:#0d0d0d;--dark2:#141414;--dark3:#1e1e1e;--dark4:#262626;
    --border:#2a2a2a;--text:#e8e0d0;--text-dim:#8a8278;--green:#27ae60;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:var(--dark);color:var(--text);font-family:'Noto Serif SC',serif;min-height:100vh;}
  .container{max-width:900px;margin:0 auto;padding:40px 24px 80px;}

  .header{border-bottom:1px solid var(--border);padding-bottom:28px;margin-bottom:36px;display:flex;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;gap:16px;}
  .brand{display:flex;flex-direction:column;gap:4px;}
  .brand-label{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--red);letter-spacing:4px;}
  .brand-title{font-size:32px;font-weight:700;line-height:1;}
  .brand-title span{color:var(--gold);}
  .header-right{text-align:right;}
  .date-display{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--text-dim);line-height:1.8;}
  .market-status{display:inline-block;font-size:10px;padding:2px 8px;font-family:'JetBrains Mono',monospace;letter-spacing:2px;margin-top:4px;}
  .status-pre{background:rgba(212,168,67,.15);color:var(--gold);border:1px solid rgba(212,168,67,.3);}
  .status-open{background:rgba(192,57,43,.15);color:var(--red-light);border:1px solid rgba(192,57,43,.3);}
  .status-noon{background:rgba(138,130,120,.15);color:var(--text-dim);border:1px solid rgba(138,130,120,.2);}
  .status-closed{background:rgba(138,130,120,.15);color:var(--text-dim);border:1px solid rgba(138,130,120,.2);}
  .status-bid{background:rgba(52,152,219,.15);color:#3498db;border:1px solid rgba(52,152,219,.3);}

  /* ★ 修改3：隐藏Worker地址，只显示运行状态 */
  .worker-panel{background:var(--dark2);border:1px solid var(--border);border-left:3px solid var(--gold);padding:14px 20px;margin-bottom:28px;display:flex;align-items:center;gap:12px;}
  .worker-dot{width:8px;height:8px;border-radius:50%;background:var(--green);box-shadow:0 0 8px var(--green);flex-shrink:0;animation:blink 2s ease-in-out infinite;}
  @keyframes blink{0%,100%{opacity:1}50%{opacity:.4}}
  .worker-info{flex:1;}
  .worker-title{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--gold);letter-spacing:3px;margin-bottom:3px;}
  .worker-model{display:inline-block;background:rgba(212,168,67,.1);border:1px solid rgba(212,168,67,.25);color:var(--gold);font-family:'JetBrains Mono',monospace;font-size:10px;padding:2px 8px;margin-top:4px;}

  .focus-chips{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:28px;padding-bottom:28px;border-bottom:1px solid var(--border);}
  .focus-label{font-size:11px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;letter-spacing:2px;display:flex;align-items:center;margin-right:4px;white-space:nowrap;}
  .chip{padding:5px 14px;font-size:12px;font-family:'Noto Serif SC',serif;border:1px solid var(--border);background:transparent;color:var(--text-dim);cursor:pointer;transition:all .15s;border-radius:2px;}
  .chip:hover{border-color:var(--text-dim);color:var(--text);}
  .chip.active{background:rgba(192,57,43,.15);border-color:var(--red);color:var(--red-light);}

  .controls{display:flex;gap:12px;margin-bottom:32px;flex-wrap:wrap;}
  .btn{padding:12px 28px;font-family:'Noto Serif SC',serif;font-size:14px;font-weight:600;cursor:pointer;border:none;letter-spacing:2px;transition:all .2s;}
  .btn-primary{background:var(--red);color:#fff;}
  .btn-primary:hover{background:var(--red-light);transform:translateY(-1px);box-shadow:0 4px 20px rgba(192,57,43,.4);}
  .btn-primary:disabled{background:var(--dark4);color:var(--text-dim);cursor:not-allowed;transform:none;box-shadow:none;}
  .btn-secondary{background:transparent;color:var(--text-dim);border:1px solid var(--border);}
  .btn-secondary:hover{border-color:var(--text-dim);color:var(--text);}

  .loading-zone{display:none;padding:60px 0;text-align:center;}
  .loading-zone.show{display:block;}
  .loading-ticker{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--text-dim);letter-spacing:3px;margin-bottom:24px;animation:pulse 1.5s ease-in-out infinite;}
  @keyframes pulse{0%,100%{opacity:.4}50%{opacity:1}}
  .progress-bar{width:300px;height:2px;background:var(--dark4);margin:0 auto;overflow:hidden;}
  .progress-fill{height:100%;background:linear-gradient(90deg,var(--red),var(--gold));animation:slide 1.5s ease-in-out infinite;}
  @keyframes slide{0%{transform:translateX(-100%) scaleX(.5)}100%{transform:translateX(400%) scaleX(.5)}}

  .error-box{display:none;background:rgba(192,57,43,.08);border:1px solid rgba(192,57,43,.3);padding:20px 24px;margin-bottom:24px;font-size:13px;line-height:1.8;color:var(--red-light);word-break:break-all;}
  .error-box.show{display:block;}
  .output-zone{display:none;}
  .output-zone.show{display:block;}

  .briefing-header{background:var(--red);padding:16px 24px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px;}
  .briefing-header-title{font-size:13px;font-weight:700;letter-spacing:4px;color:#fff;}
  .briefing-meta{font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(255,255,255,.7);}

  .sentiment-row{display:flex;align-items:center;gap:12px;padding:14px 24px;background:var(--dark2);border:1px solid var(--border);border-top:none;margin-bottom:1px;}
  .sentiment-label{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--text-dim);letter-spacing:2px;min-width:60px;}
  .sentiment-bar{flex:1;height:4px;background:var(--dark4);border-radius:2px;overflow:hidden;}
  .sentiment-fill{height:100%;border-radius:2px;}
  .sentiment-value{font-family:'JetBrains Mono',monospace;font-size:12px;min-width:36px;text-align:right;}

  .section{border:1px solid var(--border);border-top:none;animation:fadeIn .5s ease forwards;opacity:0;}
  @keyframes fadeIn{to{opacity:1}}
  .section-header{padding:14px 24px;background:var(--dark2);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;}
  .section-icon{width:6px;height:6px;border-radius:50%;flex-shrink:0;}
  .icon-macro{background:var(--gold);box-shadow:0 0 8px var(--gold);}
  .icon-sector{background:#3498db;box-shadow:0 0 8px #3498db;}
  .icon-policy{background:var(--red);box-shadow:0 0 8px var(--red);}
  .icon-market{background:var(--green);box-shadow:0 0 8px var(--green);}
  .icon-risk{background:#9b59b6;box-shadow:0 0 8px #9b59b6;}
  .icon-watch{background:#e67e22;box-shadow:0 0 8px #e67e22;}
  .section-title{font-size:11px;letter-spacing:4px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;}
  .section-body{padding:20px 24px;background:var(--dark);}

  .news-item{padding:14px 0;border-bottom:1px solid rgba(42,42,42,.6);display:flex;gap:16px;}
  .news-item:last-child{border-bottom:none;padding-bottom:0;}
  .news-num{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--text-dim);padding-top:2px;min-width:20px;}
  .news-content{flex:1;line-height:1.9;font-size:14px;}
  .news-tag{display:inline-block;font-size:10px;padding:1px 6px;border-radius:2px;margin-right:6px;font-family:'JetBrains Mono',monospace;letter-spacing:1px;vertical-align:middle;}

  /* ★ 修改1：利好=红色 利空=绿色（中国规则）*/
  .tag-positive{background:rgba(192,57,43,.15);color:var(--red-light);border:1px solid rgba(192,57,43,.3);}
  .tag-negative{background:rgba(39,174,96,.15);color:var(--green);border:1px solid rgba(39,174,96,.3);}
  .tag-neutral{background:rgba(138,130,120,.1);color:var(--text-dim);border:1px solid rgba(138,130,120,.2);}
  .tag-warning{background:rgba(155,89,182,.15);color:#9b59b6;border:1px solid rgba(155,89,182,.3);}

  .watch-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1px;background:var(--border);}
  .watch-card{background:var(--dark);padding:14px 16px;}
  .watch-name{font-size:12px;color:var(--text-dim);margin-bottom:4px;}
  .watch-signal{font-size:13px;font-weight:600;}
  /* ★ 强多/偏多=红色，强空/偏空=绿色（中国规则）*/
  .signal-bull{color:var(--red-light);}
  .signal-bear{color:var(--green);}
  .signal-neutral{color:var(--text-dim);}

  .editor-note{background:var(--dark2);border:1px solid var(--border);border-top:none;padding:16px 24px;display:flex;gap:16px;align-items:flex-start;margin-bottom:2px;}
  .editor-note-label{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--gold);letter-spacing:2px;min-width:60px;padding-top:2px;}
  .editor-note-text{font-size:14px;line-height:1.9;color:var(--text);}
  .disclaimer{font-size:11px;color:var(--text-dim);font-family:'JetBrains Mono',monospace;line-height:1.8;margin-top:16px;padding:12px 16px;border:1px solid var(--border);background:var(--dark2);}
  .raw-content{white-space:pre-wrap;font-family:'Noto Serif SC',serif;font-size:14px;line-height:2;color:var(--text);padding:24px;background:var(--dark);border:1px solid var(--border);border-top:none;word-break:break-all;}

  ::-webkit-scrollbar{width:4px;}
  ::-webkit-scrollbar-track{background:var(--dark2);}
  ::-webkit-scrollbar-thumb{background:var(--border);}
</style>
</head>
<body>
<div class="container">

  <div class="header">
    <div class="brand">
      <div class="brand-label">MORNING BRIEFING</div>
      <div class="brand-title">A股<span>盘前</span>要闻</div>
    </div>
    <div class="header-right">
      <div class="date-display" id="dateDisplay">--</div>
      <div id="marketStatus" class="market-status status-pre">盘前时段</div>
    </div>
  </div>

  <!-- ★ 修改3：不显示Worker地址 -->
  <div class="worker-panel">
    <div class="worker-dot"></div>
    <div class="worker-info">
      <div class="worker-title">// AI 引擎 · 已就绪</div>
      <div class="worker-model">MODEL · qwen/qwen3.5-397b-a17b</div>
    </div>
  </div>

  <div class="focus-chips">
    <span class="focus-label">重点板块</span>
    <button class="chip active" data-topic="科技">科技/半导体</button>
    <button class="chip active" data-topic="新能源">新能源/储能</button>
    <button class="chip active" data-topic="消费">消费/白酒</button>
    <button class="chip" data-topic="医药">医药/生物</button>
    <button class="chip" data-topic="金融">金融/地产</button>
    <button class="chip" data-topic="军工">军工/航天</button>
    <button class="chip" data-topic="AI">AI/大模型</button>
    <button class="chip" data-topic="跨境电商">出口/跨境</button>
  </div>

  <div class="controls">
    <button class="btn btn-primary" id="generateBtn" onclick="generateBriefing()">▶ 启动 · 生成今日要闻</button>
    <button class="btn btn-secondary" onclick="clearOutput()">清空</button>
  </div>

  <div class="error-box" id="errorBox"></div>
  <div class="loading-zone" id="loadingZone">
    <div class="loading-ticker">正在连接 AI 引擎 · Qwen 分析中，请稍候...</div>
    <div class="progress-bar"><div class="progress-fill"></div></div>
  </div>
  <div class="output-zone" id="outputZone"></div>

</div>
<script>
const WORKER_URL ='https://ai-gateway.ysq4006.workers.dev/';
const MODEL      = 'qwen/qwen3.5-397b-a17b';

// ★ 修改2：精准的A股交易时段判断
function getMarketStatus(){
  const now = new Date();
  const day = now.getDay(); // 0=周日 6=周六
  const h = now.getHours();
  const m = now.getMinutes();
  const total = h * 60 + m; // 转换为分钟方便比较

  // 周末
  if(day === 0 || day === 6){
    return { text:'周末休市', cls:'status-closed' };
  }
  // 工作日各时段（分钟）
  // 集合竞价 9:15-9:30
  if(total >= 9*60+15 && total < 9*60+30){
    return { text:'集合竞价', cls:'status-bid' };
  }
  // 上午交易 9:30-11:30
  if(total >= 9*60+30 && total < 11*60+30){
    return { text:'交易中 · 上午', cls:'status-open' };
  }
  // 午间休市 11:30-13:00
  if(total >= 11*60+30 && total < 13*60){
    return { text:'午间休市', cls:'status-noon' };
  }
  // 下午交易 13:00-15:00
  if(total >= 13*60 && total < 15*60){
    return { text:'交易中 · 下午', cls:'status-open' };
  }
  // 盘前 7:00-9:15
  if(total >= 7*60 && total < 9*60+15){
    return { text:'盘前时段', cls:'status-pre' };
  }
  // 其他时间（收盘后/盘前前）
  return { text:'已收盘', cls:'status-closed' };
}

function updateHeader(){
  const now = new Date();
  document.getElementById('dateDisplay').innerHTML =
    now.toLocaleDateString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit',weekday:'long'}) +
    '<br>' + now.toLocaleTimeString('zh-CN');
  const status = getMarketStatus();
  const el = document.getElementById('marketStatus');
  el.textContent = status.text;
  el.className = 'market-status ' + status.cls;
}
updateHeader(); setInterval(updateHeader, 1000);

document.querySelectorAll('.chip').forEach(c=>c.addEventListener('click',()=>c.classList.toggle('active')));
function getTopics(){ return [...document.querySelectorAll('.chip.active')].map(c=>c.dataset.topic); }

function clearOutput(){
  document.getElementById('outputZone').innerHTML='';
  document.getElementById('outputZone').classList.remove('show');
  document.getElementById('errorBox').classList.remove('show');
}

function extractContent(data){
  if(data?.choices?.[0]?.message?.content) return data.choices[0].message.content;
  if(typeof data?.content==='string'&&data.content) return data.content;
  if(typeof data?.text==='string'&&data.text) return data.text;
  if(typeof data?.result==='string'&&data.result) return data.result;
  if(data?.choices?.[0]?.text) return data.choices[0].text;
  if(data?.choices?.[0]?.content) return data.choices[0].content;
  return JSON.stringify(data);
}

function fixTruncatedJson(str){
  str=str.trim().replace(/,\s*$/,'');
  const quotes=(str.match(/(?<!\\)"/g)||[]).length;
  if(quotes%2!==0) str+='"';
  const arrDiff=(str.match(/\[/g)||[]).length-(str.match(/\]/g)||[]).length;
  const objDiff=(str.match(/\{/g)||[]).length-(str.match(/\}/g)||[]).length;
  for(let i=0;i<arrDiff;i++) str+=']';
  for(let i=0;i<objDiff;i++) str+='}';
  return str;
}

async function generateBriefing(){
  const topics=getTopics();
  const now=new Date();
  const dateStr=now.toLocaleDateString('zh-CN',{year:'numeric',month:'long',day:'numeric',weekday:'long'});
  const topicsStr=topics.length?topics.join('、'):'综合';

  const btn=document.getElementById('generateBtn');
  btn.disabled=true; btn.textContent='生成中...';
  document.getElementById('loadingZone').classList.add('show');
  document.getElementById('outputZone').classList.remove('show');
  document.getElementById('errorBox').classList.remove('show');

  const prompt=`今天是${dateStr}，请以专业A股投资分析师角度，生成一份详细的A股盘前要闻简报。
重点关注板块：${topicsStr}

只输出以下JSON，禁止任何额外文字、注释或markdown标记：

{"date":"${dateStr}","sentiment":{"bull":65,"bear":20,"neutral":15,"summary":"一句话市场情绪概括"},"macro":[{"text":"宏观要闻一，80字","tag":"利好"},{"text":"宏观要闻二，80字","tag":"中性"},{"text":"宏观要闻三，80字","tag":"利空"}],"policy":[{"text":"政策动向一，80字","tag":"利好"},{"text":"政策动向二，80字","tag":"中性"}],"sector":[{"text":"板块要闻一，涉及${topicsStr}，80字","tag":"利好"},{"text":"板块要闻二，80字","tag":"中性"},{"text":"板块要闻三，80字","tag":"利空"}],"market":[{"text":"美股昨日走势及对A股影响，60字","tag":"中性"},{"text":"港股期货汇率联动，60字","tag":"中性"}],"risk":[{"text":"风险提示一，60字","tag":"警示"},{"text":"风险提示二，60字","tag":"警示"}],"watchlist":[{"name":"沪深300","signal":"偏多","reason":"技术面向好"},{"name":"科创50","signal":"强多","reason":"成交活跃"},{"name":"创业板指","signal":"中性","reason":"震荡整理"},{"name":"${topics[0]||'半导体'}","signal":"偏多","reason":"政策催化"},{"name":"${topics[1]||'新能源'}","signal":"强多","reason":"业绩超预期"}],"editor_note":"今日一句话操作建议不超过50字"}

tag值域：利好、利空、中性、警示。signal值域：强多、偏多、中性、偏空、强空。`;

  try{
    const response=await fetch(WORKER_URL,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({
        model:MODEL,
        messages:[{role:'user',content:prompt}],
        max_tokens:4096,
        temperature:0.20,
        top_p:0.70,
        stream:false
      })
    });

    const rawText=await response.text();
    if(!response.ok){
      let msg=`HTTP ${response.status}`;
      try{const e=JSON.parse(rawText);msg=e.detail||e.message||e.error||msg;}catch(_){}
      throw new Error(msg);
    }

    let data;
    try{data=JSON.parse(rawText);}
    catch(e){data={content:rawText};}

    const content=extractContent(data);
    const cleaned=content
      .replace(/<think>[\s\S]*?<\/think>/g,'')
      .replace(/```json/g,'').replace(/```/g,'')
      .trim();

    let briefing;
    try{
      const m=cleaned.match(/\{[\s\S]*\}/);
      let jsonStr=m?m[0]:cleaned;
      try{briefing=JSON.parse(jsonStr);}
      catch(_){briefing=JSON.parse(fixTruncatedJson(jsonStr));}
    }catch(e){
      renderRaw(cleaned||content);
      return;
    }
    renderBriefing(briefing);

  }catch(e){
    showError('生成失败：'+e.message);
  }finally{
    btn.disabled=false; btn.textContent='▶ 启动 · 生成今日要闻';
    document.getElementById('loadingZone').classList.remove('show');
  }
}

function showError(msg){
  document.getElementById('loadingZone').classList.remove('show');
  const eb=document.getElementById('errorBox');
  eb.innerHTML='⚠ '+msg; eb.classList.add('show');
  document.getElementById('generateBtn').disabled=false;
  document.getElementById('generateBtn').textContent='▶ 启动 · 生成今日要闻';
}

// ★ 修改1：利好=红色 利空=绿色 警示=紫色
function tagClass(t){
  if(t==='利好') return 'tag-positive';
  if(t==='利空') return 'tag-negative';
  if(t==='警示') return 'tag-warning';
  return 'tag-neutral';
}
function signalClass(s){ return ['强多','偏多'].includes(s)?'signal-bull':['强空','偏空'].includes(s)?'signal-bear':'signal-neutral'; }

function renderNews(items){
  if(!Array.isArray(items)) return '<div style="color:var(--text-dim);padding:8px 0">暂无数据</div>';
  return items.map((item,i)=>`
    <div class="news-item">
      <div class="news-num">${String(i+1).padStart(2,'0')}</div>
      <div class="news-content"><span class="news-tag ${tagClass(item.tag)}">${item.tag||''}</span>${item.text||''}</div>
    </div>`).join('');
}

function renderBriefing(b){
  const s=b.sentiment||{};
  const bull=s.bull||50, bear=s.bear||30;
  const html=`
    <div class="briefing-header">
      <div class="briefing-header-title">今日盘前要闻 · ${b.date||''}</div>
      <div class="briefing-meta">生成于 ${new Date().toLocaleTimeString('zh-CN')} · Qwen3.5-397B</div>
    </div>
    <div class="sentiment-row">
      <div class="sentiment-label">多方情绪</div>
      <div class="sentiment-bar"><div class="sentiment-fill" style="width:${bull}%;background:var(--red)"></div></div>
      <div class="sentiment-value" style="color:var(--red-light)">${bull}%</div>
    </div>
    <div class="sentiment-row">
      <div class="sentiment-label">空方情绪</div>
      <div class="sentiment-bar"><div class="sentiment-fill" style="width:${bear}%;background:var(--green)"></div></div>
      <div class="sentiment-value" style="color:var(--green)">${bear}%</div>
    </div>
    <div class="sentiment-row" style="margin-bottom:24px">
      <div class="sentiment-label">情绪摘要</div>
      <div style="flex:1;font-size:12px;color:var(--text-dim);font-family:'JetBrains Mono',monospace">${s.summary||'--'}</div>
    </div>
    <div class="section" style="animation-delay:.1s">
      <div class="section-header"><div class="section-icon icon-macro"></div><div class="section-title">MACRO / 宏观要闻</div></div>
      <div class="section-body">${renderNews(b.macro)}</div>
    </div>
    <div class="section" style="animation-delay:.2s">
      <div class="section-header"><div class="section-icon icon-policy"></div><div class="section-title">POLICY / 政策动向</div></div>
      <div class="section-body">${renderNews(b.policy)}</div>
    </div>
    <div class="section" style="animation-delay:.3s">
      <div class="section-header"><div class="section-icon icon-sector"></div><div class="section-title">SECTOR / 板块要闻</div></div>
      <div class="section-body">${renderNews(b.sector)}</div>
    </div>
    <div class="section" style="animation-delay:.4s">
      <div class="section-header"><div class="section-icon icon-market"></div><div class="section-title">MARKET / 市场联动</div></div>
      <div class="section-body">${renderNews(b.market)}</div>
    </div>
    <div class="section" style="animation-delay:.5s">
      <div class="section-header"><div class="section-icon icon-risk"></div><div class="section-title">RISK / 风险提示</div></div>
      <div class="section-body">${renderNews(b.risk)}</div>
    </div>
    <div class="section" style="animation-delay:.6s">
      <div class="section-header"><div class="section-icon icon-watch"></div><div class="section-title">WATCHLIST / 今日关注</div></div>
      <div class="watch-grid">
        ${(b.watchlist||[]).map(w=>`
          <div class="watch-card">
            <div class="watch-name">${w.name||''}</div>
            <div class="watch-signal ${signalClass(w.signal||'')}">${w.signal||'--'}</div>
            <div style="font-size:11px;color:var(--text-dim);margin-top:4px;font-family:'JetBrains Mono',monospace">${w.reason||''}</div>
          </div>`).join('')}
      </div>
    </div>
    <div class="editor-note">
      <div class="editor-note-label">今日建议</div>
      <div class="editor-note-text">${b.editor_note||'--'}</div>
    </div>
    <div class="disclaimer">⚠ 本简报由 Qwen3.5-397B AI 生成，不含实时行情，仅供学习参考，不构成投资建议。投资有风险，入市需谨慎。</div>`;
  const zone=document.getElementById('outputZone');
  zone.innerHTML=html; zone.classList.add('show');
  zone.scrollIntoView({behavior:'smooth',block:'start'});
}

function renderRaw(text){
  const zone=document.getElementById('outputZone');
  zone.innerHTML=`
    <div class="briefing-header">
      <div class="briefing-header-title">今日盘前要闻（原始输出）</div>
      <div class="briefing-meta">${new Date().toLocaleTimeString('zh-CN')} · Qwen3.5</div>
    </div>
    <div class="raw-content">${text.replace(/</g,'&lt;').replace(/>/g,'&gt;')}</div>
    <div class="disclaimer">⚠ JSON解析失败，显示原始内容。AI生成内容仅供参考，不构成投资建议。</div>`;
  zone.classList.add('show');
  zone.scrollIntoView({behavior:'smooth',block:'start'});
}
</script>
</body>
</html>
